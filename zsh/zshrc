#
# Executes commands at the start of an interactive session.
#

# Zsh Options:
# Quickly change directories (e.g. $ foo --> $ cd foo)
setopt auto_cd 

# History:
export HISTFILE=~/.zsh_history
export HISTSIZE=10000
export SAVEHIST=10000
setopt SHARE_HISTORY

# All sessions append to one command history
setopt APPEND_HISTORY

# Add commands to history as they are typed (don't wait until exit)
setopt inc_append_history

# Don't write duplicates to history & remove extra blanks
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS

# Load aliases:
alias aliases='vi $HOME/.dotfiles/zsh/aliases.zsh'
source "$HOME/.dotfiles/zsh/aliases.zsh"

# Load bindings:
alias bindings='vi $HOME/.dotfiles/zsh/bindings.zsh'
source "$HOME/.dotfiles/zsh/bindings.zsh"

# Pure prompt:
# <https://github.com/sindresorhus/pure>
autoload -U promptinit && promptinit
prompt pure

# Show current vi mode in prompt:
PROMPT='%(?.%F{magenta}.%F{red})${${KEYMAP/vicmd/❮%f}/(main|viins)/❯%f} '
function zle-line-init zle-keymap-select {
    zle reset-prompt
}
zle -N zle-line-init
zle -N zle-keymap-select

# Completion:
# case-insensitive (all), partial-word and then substring completion
autoload -U compinit
compinit
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' \
    'r:|[._-]=* r:|=*' 'l:|=* r:|=*'
set completion-ignore-case On

# pasting with tabs doesn't perform completion
zstyle ':completion:*' insert-tab pending
