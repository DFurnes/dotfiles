#
# Executes commands at the start of an interactive session.
#

# Quickly change directories (e.g. $ foo --> $ cd foo)
setopt auto_cd 

# enable history
SAVEHIST=100
HISTFILE=~/.zsh_history

# Don't write duplicates to history & remove extra blanks
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS
setopt APPEND_HISTORY

# FZF shell integration
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# Load aliases & bindings:
source "$HOME/.dotfiles/zsh/bindings.zsh"
source "$HOME/.dotfiles/zsh/aliases.zsh"

# Source bash aliases if they exist:
[ -f ~/.bash_aliases ] && source ~/.bash_aliases

# Quick edit:
function zshrc() { vi $HOME/.dotfiles/zsh/zshrc && source ~/.zshrc }
function aliases() { vi $HOME/.dotfiles/zsh/aliases.zsh && source ~/.zshrc }
function bindings() { vi $HOME/.dotfiles/zsh/bindings.zsh && source ~/.zshrc }

# Purer prompt:
# <https://github.com/dfurnes/purer>
autoload -U promptinit && promptinit
export PURE_PROMPT_SYMBOL_COLOR="white"
export PURE_PROMPT_SYMBOL="Î»"
prompt purer

# Completion:
# case-insensitive (all), partial-word and then substring completion
autoload -U compinit && compinit
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' \
    'r:|[._-]=* r:|=*' 'l:|=* r:|=*'
set completion-ignore-case On

# make completion speedier
zstyle ':completion:*' accept-exact '*(N)'
zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path ~/.zsh/cache

# pasting with tabs doesn't perform completion
zstyle ':completion:*' insert-tab pending

# Syntax highlighting
if [ -f "/usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ]; then
  source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
  ZSH_HIGHLIGHT_STYLES[unknown-token]='none'
  ZSH_HIGHLIGHT_STYLES[precommand]='fg=yellow,underline'
  ZSH_HIGHLIGHT_STYLES[command]='fg=yellow'
  ZSH_HIGHLIGHT_STYLES[alias]='fg=yellow'
  ZSH_HIGHLIGHT_STYLES[builtin]='fg=yellow'
  ZSH_HIGHLIGHT_STYLES[function]='fg=yellow'
  ZSH_HIGHLIGHT_STYLES[single-quoted-argument]='fg=green'
  ZSH_HIGHLIGHT_STYLES[double-quoted-argument]='fg=green'
fi

if [ -f "$HOME/.zshrc.local" ]; then
  source $HOME/.zshrc.local
fi
